# SSE Token

## 功能

用于 SSE 连接的认证和鉴权

## 生成规则

使用 Ed25519 算法对特定内容进行签名

## Token 结构

- 4 字节 HEADER (固定值 "SSE\0")
- 4 字节 时间戳 epoch (Unix 时间戳)
- 4 字节 nonce (随机数，防重放攻击)
- 32 字节 Public Key (用户公钥)
- 64 字节 Ed25519 签名

## 生成步骤

1. 生成随机 nonce (4 字节)
2. 构造明文内容：`HEADER + Timestamp + Nonce + PublicKey` (共 44 字节)
3. 使用用户私钥对明文内容进行 Ed25519 签名，得到 64 字节签名
4. 组合完整内容：`明文内容 + 签名` (共 108 字节)
5. 对 108 字节内容进行 Base64 编码，得到最终 Token

## 验证步骤

1. Base64 解码 Token 得到 108 字节内容
2. 提取前 44 字节作为明文内容
3. 提取后 64 字节作为签名
4. 使用用户公钥验证签名
5. 检查时间戳是否在 ±5 分钟内有效
6. 检查 nonce 是否在服务端缓存中（防重放攻击）

## 使用场景

- SSE 长连接建立时的身份验证
- 实时事件推送的权限控制
- 连接状态的持续验证

## 安全特性

- **时间窗口限制** - ±5 分钟有效期，防止过期 Token 使用
- **防重放攻击** - nonce 确保每个 Token 的唯一性
- **强签名算法** - Ed25519 提供高安全性
- **轻量级验证** - 适合频繁的 SSE 连接验证
