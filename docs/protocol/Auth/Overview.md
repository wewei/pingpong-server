# 认证与鉴权

[← 返回协议概览](../Overview.md)

## 概述

由于用户身份去中心化，服务不会为用户发放访问 Token。我们通过协议来规定用户的 Id 和各类调用的 Token 生成校验规则。
当访问 endpoint-url 时，通过 Authorization Header 发送 Bearer Token，来进行身份认证和鉴权。

## 认证机制

### 用户 Id

**生成方法：** 采用 Ed25519 椭圆曲线算法生成公私钥对

**步骤：**
1. 使用 Ed25519 算法生成 32 字节私钥和 32 字节公钥
2. 计算用户 Id：`Id = RIPEMD-160(SHA-256(public-key))`
3. 用户 Id 为 20 字节，同 BitCoin 地址生成方法

**密钥生成：**
- 私钥：32 字节，用于签名 Token
- 公钥：32 字节，用于验证签名和生成用户 Id
- 用户 Id：20 字节，作为用户在系统中的唯一标识

**安全特性：**
- Ed25519 提供 128 位安全级别
- 抗量子计算攻击
- 签名速度快，验证效率高

## Token 类型

### [SSE Token](./SSEToken.md)
用于 SSE 连接的认证和鉴权

### [POST Token](./POSTToken.md)
用于 POST 请求的认证和鉴权

## 安全特性

- **去中心化身份** - 用户自主生成密钥，无需服务端注册
- **强加密算法** - 使用 Ed25519 椭圆曲线签名
- **防重放攻击** - nonce + 时间戳双重保护
- **内容完整性** - POST Token 包含 Body 哈希验证
- **时间窗口限制** - Token 有效期控制
